  /*
*========================================================================*
* Program:   Adults/create_cohorts_claims.sas                            *
*                                                                        *
* Purpose:   This program pulls all preventive services for adults 18-64 *
*		in the MarketScan data. 				 *
*                                                                        *
* Author:    Alex Hoagland/Paul Shafer                                   *
*            Boston University				                 *
*                                                                        *
* Created:   June 16, 2020	                                         *
* Updated:  		                                                 *
*========================================================================*;
*/
   
*Set libraries;
libname in '/projectnb2/marketscan' access=readonly;
libname out '/project/caretaking/';

proc import out=out.allfamilies
    datafile="AllFamilies.csv"
    dbms=csv;
run; 
        
/*-------------------------*
* Create OUTPATIENT sample *
*--------------------------*/;
       
*Pull and save all outpatient preventive claims; 
data out.outpatient2009(compress=yes); 
   if _N_=1 then do;
   declare hash ids(dataset:"out.allfamilies");
   ids.definekey('famid');
   ids.definedone();
   end;
        set in.ms_o_2009(keep=enrolid year sex dx1 dx2 dx3 dx4 proc1 pay cob copay coins ded:); 
   famid = floor(enrolid/100); 
   if ids.find()^=0 then delete;

   /* ALL PREVENTIVE SERVICES ONLY */; 

   /*Administration of contraceptives (part 1)*/;
   if ((proc1 in: ('96372', '57170', '58340', '58565', '58600', '58605', '58611', '58615', '58670', '58671', 
                  '74740', 'A4261', 'A4264', 'A4266', '11976', '11981', '11982', '11983', '58300', '58301', 
		  'J1050', 'J1051', 'J1055', 'J1056', 'J7302', 'J7306', 'J7307', 'S4981', 'S4989', 'J7300', 
		  'Q0090') or 
       dx1 in: ('V2501', 'V2502', 'V2503', 'V2509', 'V2511', 'V2512', 'V2513', 'V2540', 'V2541', 'V2542', 
		'V2543', 'V2549', 'V255', 'V258', 'V259', 'Z30011', 'Z30012', 'Z30013', 'Z30014', 'Z30018', 
		'Z30019', 'Z3009', 'Z3040', 'Z3041', 'Z3042', 'Z30430', 'Z30431', 'Z30432', 'Z30433', 'Z3049', 'Z308', 'Z309') or 
       dx2 in: ('V2501', 'V2502', 'V2503', 'V2509', 'V2511', 'V2512', 'V2513', 'V2540', 'V2541', 'V2542', 'V2543',
		 'V2549', 'V255', 'V258', 'V259', 'Z30011', 'Z30012', 'Z30013', 'Z30014', 'Z30018', 'Z30019', 
		'Z3009', 'Z3040', 'Z3041', 'Z3042', 'Z30430', 'Z30431', 'Z30432', 'Z30433', 'Z3049', 'Z308', 'Z309') or 
       dx3 in: ('V2501', 'V2502', 'V2503', 'V2509', 'V2511', 'V2512', 'V2513', 'V2540', 'V2541', 'V2542', 'V2543', 
		'V2549', 'V255', 'V258', 'V259', 'Z30011', 'Z30012', 'Z30013', 'Z30014', 'Z30018', 'Z30019', 'Z3009', 
		'Z3040', 'Z3041', 'Z3042', 'Z30430', 'Z30431', 'Z30432', 'Z30433', 'Z3049', 'Z308', 'Z309') or 
       dx4 in: ('V2501', 'V2502', 'V2503', 'V2509', 'V2511', 'V2512', 'V2513', 'V2540', 'V2541', 'V2542', 
		'V2543', 'V2549', 'V255', 'V258', 'V259', 'Z30011', 'Z30012', 'Z30013', 'Z30014', 'Z30018', 
		'Z30019', 'Z3009', 'Z3040', 'Z3041', 'Z3042', 'Z30430', 'Z30431', 'Z30432', 'Z30433', 'Z3049', 'Z308', 'Z309')) and
       sex = 2) then svc_contraceptive = 1; 
    else svc_contraceptive = 0; 

   /* Alcohol/Tobacco Misuse Counseling */;
   if ((dx1 in: ('V6542', 'V6549', 'V791', 'Z7189', 'Z1389', 'Z7141') or 
       dx2 in: ('V6542', 'V6549', 'V791', 'Z7189', 'Z1389', 'Z7141') or 
       dx3 in: ('V6542', 'V6549', 'V791', 'Z7189', 'Z1389', 'Z7141') or 
       dx4 in: ('V6542', 'V6549', 'V791', 'Z7189', 'Z1389', 'Z7141')) and  
       proc1 in: ('99401', '99402', '99403', '99404', '99408', '99409', '99411', '99412', 'G0396', 'G0397', 'G0442')) then svc_subab = 1; 
   if (proc1 in: ('99401', '99402', '99403', '99404', '99406', '99407', 'C9801', 'C9802', 'G0436', 'G0437', 'S9075', 'S9453')) then svc_subab = 1;
   if missing(svc_subab) then svc_subab = 0; 

   /* All Cancer Screenings */;
   if ((dx1 in: ('V103', 'V1043', 'V163', 'V1641', 'Z803', 'Z8041', 'Z1501', 'Z1502', 'Z853', 'Z8543') or 
       dx2 in: ('V103', 'V1043', 'V163', 'V1641', 'Z803', 'Z8041', 'Z1501', 'Z1502', 'Z853', 'Z8543') or 
       dx3 in: ('V103', 'V1043', 'V163', 'V1641', 'Z803', 'Z8041', 'Z1501', 'Z1502', 'Z853', 'Z8543') or 
       dx4 in: ('V103', 'V1043', 'V163', 'V1641', 'Z803', 'Z8041', 'Z1501', 'Z1502', 'Z853', 'Z8543')) and  
       sex = 2 and 
       proc1 in: ('99201', '99202', '99203', '99204', '99205', '99211', '99212', '99213', '99214', '99215', '99385', '99386', '99387', '99395', '99396', '99397', '96040', 'S0265')) 
   then svc_cancerscreen = 1;

   if (sex = 2 and proc1 in: ('77057', '77052', 'G0202', '77067', '77065', '77066', '76083', '76092')) then svc_cancerscreen = 1;

   if ((dx1 in: ('V700', 'V7231', 'V7232', 'V762', 'Z0000', 'Z0001', 'Z01419', 'Z124') or 
       dx2 in: ('V700', 'V7231', 'V7232', 'V762', 'Z0000', 'Z0001', 'Z01419', 'Z124') or 
       dx3 in: ('V700', 'V7231', 'V7232', 'V762', 'Z0000', 'Z0001', 'Z01419', 'Z124') or 
       dx4 in: ('V700', 'V7231', 'V7232', 'V762', 'Z0000', 'Z0001', 'Z01419', 'Z124')) and  
       sex = 2 and 
       proc1 in: ('88141', '88142', '88143', '88147', '88148', '88150', '88152', '88153', '88154', '88155', '88164', '88165', '88166', '88167', '88174', '88175', 'G0101', 'G0123', 'G0124', 'G0141', 'G0143', 'G0144', 'G0145', 'G0147', 'G0148', 'P3000', 'P3001', 'Q0091')) 
    then svc_cancerscreen = 1;

   if ((dx1 in: ('V160', 'V1851', 'V1859', 'V700', 'V7262', 'V7641', 'V7650', 'V7651', 'Z0000', 'Z0001', ' Z1210', 'Z1211', 'Z1212', 'Z800', 'Z8371', 'Z8379') or 
       dx2 in: ('V160', 'V1851', 'V1859', 'V700', 'V7262', 'V7641', 'V7650', 'V7651', 'Z0000', 'Z0001', ' Z1210', 'Z1211', 'Z1212', 'Z800', 'Z8371', 'Z8379') or 
       dx3 in: ('V160', 'V1851', 'V1859', 'V700', 'V7262', 'V7641', 'V7650', 'V7651', 'Z0000', 'Z0001', ' Z1210', 'Z1211', 'Z1212', 'Z800', 'Z8371', 'Z8379') or 
       dx4 in: ('V160', 'V1851', 'V1859', 'V700', 'V7262', 'V7641', 'V7650', 'V7651', 'Z0000', 'Z0001', ' Z1210', 'Z1211', 'Z1212', 'Z800', 'Z8371', 'Z8379')) and 
       proc1 in: ('44388', '44389', '44392', '44393', '44394', '45300', '45301', '45302', '45303', '45304', '45305', '45306', '45307', '45308', '45309', '45310', '45311', '45312', '45313', '45314', '45315', '45316', '45317', '45318', '45319', '45320', '45330', '45331', '45332', '45333', '45334', '45335', '45338', '45339', '45340', '45378', '45379', '45380', '45381', '45382', '45383', '45384', '45385', '45386', '74263', '82270', '82274', '88304', '88305', 'G0104', 'G0105', 'G0106', 'G0107', 'G0120', 'G0121', 'G0122', 'G0328', 'G0394', 'S0601', 'S3890')) 
   then svc_cancerscreen = 1;
   if missing(svc_cancerscreen) then svc_cancerscreen = 0;

   /*Cholesterol Screening */;
   if ((dx1 in: ('V700', 'V7791', 'Z0000', 'Z0001', 'Z13220', '24900', '24901', '24910', '24911', '24920', '24921', '24930', '24931', '24940', '24941', '24950', '24951', '24960', '24961', '24970', '24971', '24980', '24981', '24990', '24991', '25000', '25001', '25002', '25003', '25010', '25011', '25012', '25013', '25020', '25021', '25022', '25023', '25030', '25031', '25032', '25033', '25040', '25041', '25042', '25043', '25050', '25051', '25052', '25053', '25060', '25061', '25062', '25063', '25070', '25071', '25072', '25073', '25080', '25081', '25082', '25083', '25090', '25091', '25092', '25093', 'E0800', 'E0801', 'E0810', 'E0811', 'E0821', 'E0822', 'E0829', 'E08311', 'E08319', 'E08321', 'E08329', 'E08331', 'E08339', 'E08341', 'E08349', 'E08351', 'E08359', 'E0836', 'E0839', 'E0840', 'E0841', 'E0842', 'E0843', 'E0844', 'E0849', 'E0851', 'E0852', 'E0859', 'E08610', 'E08618', 'E08620', 'E08621', 'E08622', 'E08628', 'E08630', 'E08638', 'E08641', 'E08649', 'E0865', 'E0869', 'E088', 'E089', 'E0900', 'E0901', 'E0910', 'E0911', 'E0921', 'E0922', 'E0929', 'E09311', 'E09319', 'E09321', 'E09329', 'E09331', 'E09339', 'E09341', 'E09349', 'E09351', 'E09359', 'E0936', 'E0939', 'E0940', 'E0941', 'E0942', 'E0943', 'E0944', 'E0949', 'E0951', 'E0952', 'E0959', 'E09610', 'E09618', 'E09620', 'E09621', 'E09622', 'E09628', 'E09630', 'E09638', 'E09641', 'E09649', 'E0965', 'E0969', 'E098', 'E099', 'E1010', 'E1011', 'E1021', 'E1022', 'E1029', 'E10311', 'E10319', 'E10321', 'E10329', 'E10331', 'E10339', 'E10341', 'E10349', 'E10351', 'E10359', 'E1036', 'E1039', 'E1040', 'E1041', 'E1042', 'E1043', 'E1044', 'E1049', 'E1051', 'E1052', 'E1059', 'E10610', 'E10618', 'E10620', 'E10621', 'E10628', 'E10630', 'E10638', 'E10641', 'E10649', 'E1065', 'E1069', 'E108', 'E109', 'E1100', 'E1101', 'E1121', 'E1122', 'E1129', 'E11311', 'E11319', 'E11321', 'E11329', 'E11331', 'E11339', 'E11341', 'E11349', 'E11351', 'E11359', 'E1136', 'E1139', 'E1140', 'E1141', 'E1142', 'E1143', 'E1144', 'E1149', 'E1151', 'E1152', 'E1159', 'E11610', 'E11618', 'E11620', 'E11621', 'E11622', 'E11628', 'E11630', 'E11638', 'E11641', 'E11649', 'E1165', 'E1169', 'E118', 'E119', 'E1300', 'E1301', 'E1310', 'E1311', 'E1321', 'E1322', 'E1329', 'E13311', 'E13319', 'E13321', 'E13329', 'E13331', 'E13339', 'E13341', 'E13349', 'E13351', 'E13359', 'E1336', 'E1339', 'E1340', 'E1341', 'E1342', 'E1343', 'E1344', 'E1349', 'E1351', 'E1352', 'E1359', 'E13610', 'E13618', 'E13620', 'E13621', 'E13622', 'E13628', 'E13630', 'E13638', 'E13641', 'E13649', 'E1365', 'E1369', 'E138', 'E139', '4010', '4011', '4019', 'I10', '40200', '40201', '40210', '40211', '40290', '40291', 'I110', 'I119', '40300', '40301', '40310', '40311', '40390', '49391', 'I120', 'I129', '40400', '40401', '40402', '40403', '40410', '40411', '40412', '40413', '40490', '40491', '40492', '40493', 'I130', 'I1310', 'I1311', 'I132', '40501', '40509', '40511', '40519', '40591', '40599', 'I150', 'I151', 'I152', 'I158', 'I159', 'N262', '64201', '64203', '64204', '64211', '64213', '64214', '64221', '64223', '64224', '64230', '64231', '64233', '64234', '64291', '64293', '94294', 'O10011', 'O10012', 'O10013', 'O10019', 'O1002', 'O1003', 'O10111', 'O10112', 'O10113', 'O10119', 'O1012', 'O1013', 'O10211', 'O10212', 'O10213', 'O10219', 'O1022', 'O1023', 'O10311', 'O10312', 'O10313', 'O10319', 'O1032', 'O1033', 'O10411', 'O10412', 'O10413', 'O10419', 'O1042', 'O1043', 'O10911', 'O10912', 'O10913', 'O10919', 'O1092', 'O1093', 'O111', 'O112', 'O113', 'O119', 'O131', 'O132', 'O139', 'O161', 'O162', 'O163', 'O169') or 
       dx2 in: ('V700', 'V7791', 'Z0000', 'Z0001', 'Z13220', '24900', '24901', '24910', '24911', '24920', '24921', '24930', '24931', '24940', '24941', '24950', '24951', '24960', '24961', '24970', '24971', '24980', '24981', '24990', '24991', '25000', '25001', '25002', '25003', '25010', '25011', '25012', '25013', '25020', '25021', '25022', '25023', '25030', '25031', '25032', '25033', '25040', '25041', '25042', '25043', '25050', '25051', '25052', '25053', '25060', '25061', '25062', '25063', '25070', '25071', '25072', '25073', '25080', '25081', '25082', '25083', '25090', '25091', '25092', '25093', 'E0800', 'E0801', 'E0810', 'E0811', 'E0821', 'E0822', 'E0829', 'E08311', 'E08319', 'E08321', 'E08329', 'E08331', 'E08339', 'E08341', 'E08349', 'E08351', 'E08359', 'E0836', 'E0839', 'E0840', 'E0841', 'E0842', 'E0843', 'E0844', 'E0849', 'E0851', 'E0852', 'E0859', 'E08610', 'E08618', 'E08620', 'E08621', 'E08622', 'E08628', 'E08630', 'E08638', 'E08641', 'E08649', 'E0865', 'E0869', 'E088', 'E089', 'E0900', 'E0901', 'E0910', 'E0911', 'E0921', 'E0922', 'E0929', 'E09311', 'E09319', 'E09321', 'E09329', 'E09331', 'E09339', 'E09341', 'E09349', 'E09351', 'E09359', 'E0936', 'E0939', 'E0940', 'E0941', 'E0942', 'E0943', 'E0944', 'E0949', 'E0951', 'E0952', 'E0959', 'E09610', 'E09618', 'E09620', 'E09621', 'E09622', 'E09628', 'E09630', 'E09638', 'E09641', 'E09649', 'E0965', 'E0969', 'E098', 'E099', 'E1010', 'E1011', 'E1021', 'E1022', 'E1029', 'E10311', 'E10319', 'E10321', 'E10329', 'E10331', 'E10339', 'E10341', 'E10349', 'E10351', 'E10359', 'E1036', 'E1039', 'E1040', 'E1041', 'E1042', 'E1043', 'E1044', 'E1049', 'E1051', 'E1052', 'E1059', 'E10610', 'E10618', 'E10620', 'E10621', 'E10628', 'E10630', 'E10638', 'E10641', 'E10649', 'E1065', 'E1069', 'E108', 'E109', 'E1100', 'E1101', 'E1121', 'E1122', 'E1129', 'E11311', 'E11319', 'E11321', 'E11329', 'E11331', 'E11339', 'E11341', 'E11349', 'E11351', 'E11359', 'E1136', 'E1139', 'E1140', 'E1141', 'E1142', 'E1143', 'E1144', 'E1149', 'E1151', 'E1152', 'E1159', 'E11610', 'E11618', 'E11620', 'E11621', 'E11622', 'E11628', 'E11630', 'E11638', 'E11641', 'E11649', 'E1165', 'E1169', 'E118', 'E119', 'E1300', 'E1301', 'E1310', 'E1311', 'E1321', 'E1322', 'E1329', 'E13311', 'E13319', 'E13321', 'E13329', 'E13331', 'E13339', 'E13341', 'E13349', 'E13351', 'E13359', 'E1336', 'E1339', 'E1340', 'E1341', 'E1342', 'E1343', 'E1344', 'E1349', 'E1351', 'E1352', 'E1359', 'E13610', 'E13618', 'E13620', 'E13621', 'E13622', 'E13628', 'E13630', 'E13638', 'E13641', 'E13649', 'E1365', 'E1369', 'E138', 'E139', '4010', '4011', '4019', 'I10', '40200', '40201', '40210', '40211', '40290', '40291', 'I110', 'I119', '40300', '40301', '40310', '40311', '40390', '49391', 'I120', 'I129', '40400', '40401', '40402', '40403', '40410', '40411', '40412', '40413', '40490', '40491', '40492', '40493', 'I130', 'I1310', 'I1311', 'I132', '40501', '40509', '40511', '40519', '40591', '40599', 'I150', 'I151', 'I152', 'I158', 'I159', 'N262', '64201', '64203', '64204', '64211', '64213', '64214', '64221', '64223', '64224', '64230', '64231', '64233', '64234', '64291', '64293', '94294', 'O10011', 'O10012', 'O10013', 'O10019', 'O1002', 'O1003', 'O10111', 'O10112', 'O10113', 'O10119', 'O1012', 'O1013', 'O10211', 'O10212', 'O10213', 'O10219', 'O1022', 'O1023', 'O10311', 'O10312', 'O10313', 'O10319', 'O1032', 'O1033', 'O10411', 'O10412', 'O10413', 'O10419', 'O1042', 'O1043', 'O10911', 'O10912', 'O10913', 'O10919', 'O1092', 'O1093', 'O111', 'O112', 'O113', 'O119', 'O131', 'O132', 'O139', 'O161', 'O162', 'O163', 'O169') or 
       dx3 in: ('V700', 'V7791', 'Z0000', 'Z0001', 'Z13220', '24900', '24901', '24910', '24911', '24920', '24921', '24930', '24931', '24940', '24941', '24950', '24951', '24960', '24961', '24970', '24971', '24980', '24981', '24990', '24991', '25000', '25001', '25002', '25003', '25010', '25011', '25012', '25013', '25020', '25021', '25022', '25023', '25030', '25031', '25032', '25033', '25040', '25041', '25042', '25043', '25050', '25051', '25052', '25053', '25060', '25061', '25062', '25063', '25070', '25071', '25072', '25073', '25080', '25081', '25082', '25083', '25090', '25091', '25092', '25093', 'E0800', 'E0801', 'E0810', 'E0811', 'E0821', 'E0822', 'E0829', 'E08311', 'E08319', 'E08321', 'E08329', 'E08331', 'E08339', 'E08341', 'E08349', 'E08351', 'E08359', 'E0836', 'E0839', 'E0840', 'E0841', 'E0842', 'E0843', 'E0844', 'E0849', 'E0851', 'E0852', 'E0859', 'E08610', 'E08618', 'E08620', 'E08621', 'E08622', 'E08628', 'E08630', 'E08638', 'E08641', 'E08649', 'E0865', 'E0869', 'E088', 'E089', 'E0900', 'E0901', 'E0910', 'E0911', 'E0921', 'E0922', 'E0929', 'E09311', 'E09319', 'E09321', 'E09329', 'E09331', 'E09339', 'E09341', 'E09349', 'E09351', 'E09359', 'E0936', 'E0939', 'E0940', 'E0941', 'E0942', 'E0943', 'E0944', 'E0949', 'E0951', 'E0952', 'E0959', 'E09610', 'E09618', 'E09620', 'E09621', 'E09622', 'E09628', 'E09630', 'E09638', 'E09641', 'E09649', 'E0965', 'E0969', 'E098', 'E099', 'E1010', 'E1011', 'E1021', 'E1022', 'E1029', 'E10311', 'E10319', 'E10321', 'E10329', 'E10331', 'E10339', 'E10341', 'E10349', 'E10351', 'E10359', 'E1036', 'E1039', 'E1040', 'E1041', 'E1042', 'E1043', 'E1044', 'E1049', 'E1051', 'E1052', 'E1059', 'E10610', 'E10618', 'E10620', 'E10621', 'E10628', 'E10630', 'E10638', 'E10641', 'E10649', 'E1065', 'E1069', 'E108', 'E109', 'E1100', 'E1101', 'E1121', 'E1122', 'E1129', 'E11311', 'E11319', 'E11321', 'E11329', 'E11331', 'E11339', 'E11341', 'E11349', 'E11351', 'E11359', 'E1136', 'E1139', 'E1140', 'E1141', 'E1142', 'E1143', 'E1144', 'E1149', 'E1151', 'E1152', 'E1159', 'E11610', 'E11618', 'E11620', 'E11621', 'E11622', 'E11628', 'E11630', 'E11638', 'E11641', 'E11649', 'E1165', 'E1169', 'E118', 'E119', 'E1300', 'E1301', 'E1310', 'E1311', 'E1321', 'E1322', 'E1329', 'E13311', 'E13319', 'E13321', 'E13329', 'E13331', 'E13339', 'E13341', 'E13349', 'E13351', 'E13359', 'E1336', 'E1339', 'E1340', 'E1341', 'E1342', 'E1343', 'E1344', 'E1349', 'E1351', 'E1352', 'E1359', 'E13610', 'E13618', 'E13620', 'E13621', 'E13622', 'E13628', 'E13630', 'E13638', 'E13641', 'E13649', 'E1365', 'E1369', 'E138', 'E139', '4010', '4011', '4019', 'I10', '40200', '40201', '40210', '40211', '40290', '40291', 'I110', 'I119', '40300', '40301', '40310', '40311', '40390', '49391', 'I120', 'I129', '40400', '40401', '40402', '40403', '40410', '40411', '40412', '40413', '40490', '40491', '40492', '40493', 'I130', 'I1310', 'I1311', 'I132', '40501', '40509', '40511', '40519', '40591', '40599', 'I150', 'I151', 'I152', 'I158', 'I159', 'N262', '64201', '64203', '64204', '64211', '64213', '64214', '64221', '64223', '64224', '64230', '64231', '64233', '64234', '64291', '64293', '94294', 'O10011', 'O10012', 'O10013', 'O10019', 'O1002', 'O1003', 'O10111', 'O10112', 'O10113', 'O10119', 'O1012', 'O1013', 'O10211', 'O10212', 'O10213', 'O10219', 'O1022', 'O1023', 'O10311', 'O10312', 'O10313', 'O10319', 'O1032', 'O1033', 'O10411', 'O10412', 'O10413', 'O10419', 'O1042', 'O1043', 'O10911', 'O10912', 'O10913', 'O10919', 'O1092', 'O1093', 'O111', 'O112', 'O113', 'O119', 'O131', 'O132', 'O139', 'O161', 'O162', 'O163', 'O169') or 
       dx4 in: ('V700', 'V7791', 'Z0000', 'Z0001', 'Z13220', '24900', '24901', '24910', '24911', '24920', '24921', '24930', '24931', '24940', '24941', '24950', '24951', '24960', '24961', '24970', '24971', '24980', '24981', '24990', '24991', '25000', '25001', '25002', '25003', '25010', '25011', '25012', '25013', '25020', '25021', '25022', '25023', '25030', '25031', '25032', '25033', '25040', '25041', '25042', '25043', '25050', '25051', '25052', '25053', '25060', '25061', '25062', '25063', '25070', '25071', '25072', '25073', '25080', '25081', '25082', '25083', '25090', '25091', '25092', '25093', 'E0800', 'E0801', 'E0810', 'E0811', 'E0821', 'E0822', 'E0829', 'E08311', 'E08319', 'E08321', 'E08329', 'E08331', 'E08339', 'E08341', 'E08349', 'E08351', 'E08359', 'E0836', 'E0839', 'E0840', 'E0841', 'E0842', 'E0843', 'E0844', 'E0849', 'E0851', 'E0852', 'E0859', 'E08610', 'E08618', 'E08620', 'E08621', 'E08622', 'E08628', 'E08630', 'E08638', 'E08641', 'E08649', 'E0865', 'E0869', 'E088', 'E089', 'E0900', 'E0901', 'E0910', 'E0911', 'E0921', 'E0922', 'E0929', 'E09311', 'E09319', 'E09321', 'E09329', 'E09331', 'E09339', 'E09341', 'E09349', 'E09351', 'E09359', 'E0936', 'E0939', 'E0940', 'E0941', 'E0942', 'E0943', 'E0944', 'E0949', 'E0951', 'E0952', 'E0959', 'E09610', 'E09618', 'E09620', 'E09621', 'E09622', 'E09628', 'E09630', 'E09638', 'E09641', 'E09649', 'E0965', 'E0969', 'E098', 'E099', 'E1010', 'E1011', 'E1021', 'E1022', 'E1029', 'E10311', 'E10319', 'E10321', 'E10329', 'E10331', 'E10339', 'E10341', 'E10349', 'E10351', 'E10359', 'E1036', 'E1039', 'E1040', 'E1041', 'E1042', 'E1043', 'E1044', 'E1049', 'E1051', 'E1052', 'E1059', 'E10610', 'E10618', 'E10620', 'E10621', 'E10628', 'E10630', 'E10638', 'E10641', 'E10649', 'E1065', 'E1069', 'E108', 'E109', 'E1100', 'E1101', 'E1121', 'E1122', 'E1129', 'E11311', 'E11319', 'E11321', 'E11329', 'E11331', 'E11339', 'E11341', 'E11349', 'E11351', 'E11359', 'E1136', 'E1139', 'E1140', 'E1141', 'E1142', 'E1143', 'E1144', 'E1149', 'E1151', 'E1152', 'E1159', 'E11610', 'E11618', 'E11620', 'E11621', 'E11622', 'E11628', 'E11630', 'E11638', 'E11641', 'E11649', 'E1165', 'E1169', 'E118', 'E119', 'E1300', 'E1301', 'E1310', 'E1311', 'E1321', 'E1322', 'E1329', 'E13311', 'E13319', 'E13321', 'E13329', 'E13331', 'E13339', 'E13341', 'E13349', 'E13351', 'E13359', 'E1336', 'E1339', 'E1340', 'E1341', 'E1342', 'E1343', 'E1344', 'E1349', 'E1351', 'E1352', 'E1359', 'E13610', 'E13618', 'E13620', 'E13621', 'E13622', 'E13628', 'E13630', 'E13638', 'E13641', 'E13649', 'E1365', 'E1369', 'E138', 'E139', '4010', '4011', '4019', 'I10', '40200', '40201', '40210', '40211', '40290', '40291', 'I110', 'I119', '40300', '40301', '40310', '40311', '40390', '49391', 'I120', 'I129', '40400', '40401', '40402', '40403', '40410', '40411', '40412', '40413', '40490', '40491', '40492', '40493', 'I130', 'I1310', 'I1311', 'I132', '40501', '40509', '40511', '40519', '40591', '40599', 'I150', 'I151', 'I152', 'I158', 'I159', 'N262', '64201', '64203', '64204', '64211', '64213', '64214', '64221', '64223', '64224', '64230', '64231', '64233', '64234', '64291', '64293', '94294', 'O10011', 'O10012', 'O10013', 'O10019', 'O1002', 'O1003', 'O10111', 'O10112', 'O10113', 'O10119', 'O1012', 'O1013', 'O10211', 'O10212', 'O10213', 'O10219', 'O1022', 'O1023', 'O10311', 'O10312', 'O10313', 'O10319', 'O1032', 'O1033', 'O10411', 'O10412', 'O10413', 'O10419', 'O1042', 'O1043', 'O10911', 'O10912', 'O10913', 'O10919', 'O1092', 'O1093', 'O111', 'O112', 'O113', 'O119', 'O131', 'O132', 'O139', 'O161', 'O162', 'O163', 'O169')) and  
       proc1 in: ('36415', '36416', '80061', '82465', '83718', '83719', '83721', '84478')) then svc_cholesterol = 1;
   else svc_cholesterol = 0;

   /*Depression Screening*/;
   if ((dx1 in: ('V790', 'Z1389') or 
       dx2 in: ('V790', 'Z1389') or 
       dx3 in: ('V790', 'Z1389') or 
       dx4 in: ('V790', 'Z1389')) and 
       proc1 in: ('96127', '96160', '96161', '99420', 'G0444')) then svc_depression = 1;
   else svc_depression = 0; 

   /*Diabetes Screening*/;
   if ((dx1 in: ('V700', 'V771', 'Z0000', 'Z0001', 'Z131', '4010', '4011', '4019', 'I10', '40200', '40201', '40210', '40211', '40290', '40291', 'I110', 'I119', '40300', '40301', '40310', '40311', '40390', '49391', 'I120', 'I129', '40400', '40401', '40402', '40403', '40410', '40411', '40412', '40413', '40490', '40491', '40492', '40493', 'I130', 'I1310', 'I1311', 'I132', '40501', '40509', '40511', '40519', '40591', '40599', 'I150', 'I151', 'I152', 'I158', 'I159', 'N262', '64201', '64203', '64204', '64211', '64213', '64214', '64221', '64223', '64224', '64230', '64231', '64233', '64234', '64291', '64293', '94294', 'O10011', 'O10012', 'O10013', 'O10019', 'O1002', 'O1003', 'O10111', 'O10112', 'O10113', 'O10119', 'O1012', 'O1013', 'O10211', 'O10212', 'O10213', 'O10219', 'O1022', 'O1023', 'O10311', 'O10312', 'O10313', 'O10319', 'O1032', 'O1033', 'O10411', 'O10412', 'O10413', 'O10419', 'O1042', 'O1043', 'O10911', 'O10912', 'O10913', 'O10919', 'O1092', 'O1093', 'O111', 'O112', 'O113', 'O119', 'O131', 'O132', 'O139', 'O161', 'O162', 'O163', 'O169') or 
       dx2 in: ('V700', 'V771', 'Z0000', 'Z0001', 'Z131', '4010', '4011', '4019', 'I10', '40200', '40201', '40210', '40211', '40290', '40291', 'I110', 'I119', '40300', '40301', '40310', '40311', '40390', '49391', 'I120', 'I129', '40400', '40401', '40402', '40403', '40410', '40411', '40412', '40413', '40490', '40491', '40492', '40493', 'I130', 'I1310', 'I1311', 'I132', '40501', '40509', '40511', '40519', '40591', '40599', 'I150', 'I151', 'I152', 'I158', 'I159', 'N262', '64201', '64203', '64204', '64211', '64213', '64214', '64221', '64223', '64224', '64230', '64231', '64233', '64234', '64291', '64293', '94294', 'O10011', 'O10012', 'O10013', 'O10019', 'O1002', 'O1003', 'O10111', 'O10112', 'O10113', 'O10119', 'O1012', 'O1013', 'O10211', 'O10212', 'O10213', 'O10219', 'O1022', 'O1023', 'O10311', 'O10312', 'O10313', 'O10319', 'O1032', 'O1033', 'O10411', 'O10412', 'O10413', 'O10419', 'O1042', 'O1043', 'O10911', 'O10912', 'O10913', 'O10919', 'O1092', 'O1093', 'O111', 'O112', 'O113', 'O119', 'O131', 'O132', 'O139', 'O161', 'O162', 'O163', 'O169') or 
       dx3 in: ('V700', 'V771', 'Z0000', 'Z0001', 'Z131', '4010', '4011', '4019', 'I10', '40200', '40201', '40210', '40211', '40290', '40291', 'I110', 'I119', '40300', '40301', '40310', '40311', '40390', '49391', 'I120', 'I129', '40400', '40401', '40402', '40403', '40410', '40411', '40412', '40413', '40490', '40491', '40492', '40493', 'I130', 'I1310', 'I1311', 'I132', '40501', '40509', '40511', '40519', '40591', '40599', 'I150', 'I151', 'I152', 'I158', 'I159', 'N262', '64201', '64203', '64204', '64211', '64213', '64214', '64221', '64223', '64224', '64230', '64231', '64233', '64234', '64291', '64293', '94294', 'O10011', 'O10012', 'O10013', 'O10019', 'O1002', 'O1003', 'O10111', 'O10112', 'O10113', 'O10119', 'O1012', 'O1013', 'O10211', 'O10212', 'O10213', 'O10219', 'O1022', 'O1023', 'O10311', 'O10312', 'O10313', 'O10319', 'O1032', 'O1033', 'O10411', 'O10412', 'O10413', 'O10419', 'O1042', 'O1043', 'O10911', 'O10912', 'O10913', 'O10919', 'O1092', 'O1093', 'O111', 'O112', 'O113', 'O119', 'O131', 'O132', 'O139', 'O161', 'O162', 'O163', 'O169') or 
       dx4 in: ('V700', 'V771', 'Z0000', 'Z0001', 'Z131', '4010', '4011', '4019', 'I10', '40200', '40201', '40210', '40211', '40290', '40291', 'I110', 'I119', '40300', '40301', '40310', '40311', '40390', '49391', 'I120', 'I129', '40400', '40401', '40402', '40403', '40410', '40411', '40412', '40413', '40490', '40491', '40492', '40493', 'I130', 'I1310', 'I1311', 'I132', '40501', '40509', '40511', '40519', '40591', '40599', 'I150', 'I151', 'I152', 'I158', 'I159', 'N262', '64201', '64203', '64204', '64211', '64213', '64214', '64221', '64223', '64224', '64230', '64231', '64233', '64234', '64291', '64293', '94294', 'O10011', 'O10012', 'O10013', 'O10019', 'O1002', 'O1003', 'O10111', 'O10112', 'O10113', 'O10119', 'O1012', 'O1013', 'O10211', 'O10212', 'O10213', 'O10219', 'O1022', 'O1023', 'O10311', 'O10312', 'O10313', 'O10319', 'O1032', 'O1033', 'O10411', 'O10412', 'O10413', 'O10419', 'O1042', 'O1043', 'O10911', 'O10912', 'O10913', 'O10919', 'O1092', 'O1093', 'O111', 'O112', 'O113', 'O119', 'O131', 'O132', 'O139', 'O161', 'O162', 'O163', 'O169')) and 
       proc1 in: ('36415', '36416', '82947', '82948', '82950', '82951', '82952', '83036')) then svc_diabetes = 1;
    else svc_diabetes = 0;

   /* All Immunizations */; 
   if ((dx1 in: ('V202', 'V700', 'V035', 'V036', 'V037', 'V0381', 'V0382', 'V0389', 'V040', 'V042', 'V043', 'V046', 'V048', 'V0481', 'V0489', 'V053', 'V054', 'V061', 'V062', 'V063', 'V064', 'V065', 'V066', 'V068', 'V069', 'Z00121', 'Z00129', 'Z0000', 'Z0001', 'Z0001', 'Z23') or 
       dx2 in: ('V202', 'V700', 'V035', 'V036', 'V037', 'V0381', 'V0382', 'V0389', 'V040', 'V042', 'V043', 'V046', 'V048', 'V0481', 'V0489', 'V053', 'V054', 'V061', 'V062', 'V063', 'V064', 'V065', 'V066', 'V068', 'V069', 'Z00121', 'Z00129', 'Z0000', 'Z0001', 'Z0001', 'Z23') or 
       dx3 in: ('V202', 'V700', 'V035', 'V036', 'V037', 'V0381', 'V0382', 'V0389', 'V040', 'V042', 'V043', 'V046', 'V048', 'V0481', 'V0489', 'V053', 'V054', 'V061', 'V062', 'V063', 'V064', 'V065', 'V066', 'V068', 'V069', 'Z00121', 'Z00129', 'Z0000', 'Z0001', 'Z0001', 'Z23') or 
       dx4 in: ('V202', 'V700', 'V035', 'V036', 'V037', 'V0381', 'V0382', 'V0389', 'V040', 'V042', 'V043', 'V046', 'V048', 'V0481', 'V0489', 'V053', 'V054', 'V061', 'V062', 'V063', 'V064', 'V065', 'V066', 'V068', 'V069', 'Z00121', 'Z00129', 'Z0000', 'Z0001', 'Z0001', 'Z23')) and 
       proc1 in: ('90460', '90461', '90465', '90466', '90467', '90468', '90470', '90471', '90472', '90473', '90474', 'G0008', 'G0009', 'G0010', 'G0377', 'G9141', 'J3530', '90696', '90698', '90700', '90701', '90702', '90703', '90704', '90705', '90706', '90707', '90708', '90710', '90712', '90713', '90714', '90715', '90718', '90719', '90720', '90721', '90723', '90645', '90646', '90647', '90648', '90632', '90633', '90634', '90636', '90740', '90743', '90744', '90746', '90747', '90748', '90649', '90650', '90669', '90670', 'S0195', '90732', '90680', '90681', '90716', '90736')) 
   then svc_immunization = 1;

   if ((dx1 in: ('V202', 'V700', 'V035', 'V036', 'V037', 'V0381', 'V0382', 'V0389', 'V040', 'V042', 'V043', 'V046', 'V048', 'V0481', 'V0489', 'V053', 'V054', 'V061', 'V062', 'V063', 'V064', 'V065', 'V066', 'V068', 'V069', 'Z00121', 'Z00129', 'Z0000', 'Z0001', 'Z0001', 'Z23') or 
       dx2 in: ('V202', 'V700', 'V035', 'V036', 'V037', 'V0381', 'V0382', 'V0389', 'V040', 'V042', 'V043', 'V046', 'V048', 'V0481', 'V0489', 'V053', 'V054', 'V061', 'V062', 'V063', 'V064', 'V065', 'V066', 'V068', 'V069', 'Z00121', 'Z00129', 'Z0000', 'Z0001', 'Z0001', 'Z23') or 
       dx3 in: ('V202', 'V700', 'V035', 'V036', 'V037', 'V0381', 'V0382', 'V0389', 'V040', 'V042', 'V043', 'V046', 'V048', 'V0481', 'V0489', 'V053', 'V054', 'V061', 'V062', 'V063', 'V064', 'V065', 'V066', 'V068', 'V069', 'Z00121', 'Z00129', 'Z0000', 'Z0001', 'Z0001', 'Z23') or 
       dx4 in: ('V202', 'V700', 'V035', 'V036', 'V037', 'V0381', 'V0382', 'V0389', 'V040', 'V042', 'V043', 'V046', 'V048', 'V0481', 'V0489', 'V053', 'V054', 'V061', 'V062', 'V063', 'V064', 'V065', 'V066', 'V068', 'V069', 'Z00121', 'Z00129', 'Z0000', 'Z0001', 'Z0001', 'Z23')) and 
       proc1 in: ('90653', '90654', '90655', '90656', '90657', '90658', '90660', '90661', '90662', '90664', '90666', '90667', '90668', '90672', '90685', '90686', '90687', '90688', 'Q2033', 'Q2034', 'Q2035', 'Q2036', 'Q2037', 'Q2038', 'Q2039')) 
   then svc_immunization = 1;
   if missing(svc_immunization) then svc_immunization = 0; 

   /*Obesity Screening*/;
   if ((dx1 in: ('V8530', 'V8531', 'V8532', 'V8533', 'V8534', 'V8535', 'V8536', 'V8537', 'V8538', 'V8539', 'V8541', 'V8542', 'V8543', 'V8544', 'V8545', '27800', '27801', 'Z6830', 'Z6831', 'Z6832', 'Z6833', 'Z6834', 'Z6835', 'Z6836', 'Z6837', 'Z6838', 'Z6839', 'Z6841', 'Z6842', 'Z6843', 'Z6844', 'Z6845', 'E6601', 'E6609', 'E661', 'E668', 'E66', '4010', '4011', '4019', 'I10', '40200', '40201', '40210', '40211', '40290', '40291', 'I110', 'I119', '40300', '40301', '40310', '40311', '40390', '49391', 'I120', 'I129', '40400', '40401', '40402', '40403', '40410', '40411', '40412', '40413', '40490', '40491', '40492', '40493', 'I130', 'I1310', 'I1311', 'I132', '40501', '40509', '40511', '40519', '40591', '40599', 'I150', 'I151', 'I152', 'I158', 'I159', 'N262', '64201', '64203', '64204', '64211', '64213', '64214', '64221', '64223', '64224', '64230', '64231', '64233', '64234', '64291', '64293', '94294', 'O10011', 'O10012', 'O10013', 'O10019', 'O1002', 'O1003', 'O10111', 'O10112', 'O10113', 'O10119', 'O1012', 'O1013', 'O10211', 'O10212', 'O10213', 'O10219', 'O1022', 'O1023', 'O10311', 'O10312', 'O10313', 'O10319', 'O1032', 'O1033', 'O10411', 'O10412', 'O10413', 'O10419', 'O1042', 'O1043', 'O10911', 'O10912', 'O10913', 'O10919', 'O1092', 'O1093', 'O111', 'O112', 'O113', 'O119', 'O131', 'O132', 'O139', 'O161', 'O162', 'O163', 'O169', '24900', '24901', '24910', '24911', '24920', '24921', '24930', '24931', '24940', '24941', '24950', '24951', '24960', '24961', '24970', '24971', '24980', '24981', '24990', '24991', '25000', '25001', '25002', '25003', '25010', '25011', '25012', '25013', '25020', '25021', '25022', '25023', '25030', '25031', '25032', '25033', '25040', '25041', '25042', '25043', '25050', '25051', '25052', '25053', '25060', '25061', '25062', '25063', '25070', '25071', '25072', '25073', '25080', '25081', '25082', '25083', '25090', '25091', '25092', '25093', 'E0800', 'E0801', 'E0810', 'E0811', 'E0821', 'E0822', 'E0829', 'E08311', 'E08319', 'E08321', 'E08329', 'E08331', 'E08339', 'E08341', 'E08349', 'E08351', 'E08359', 'E0836', 'E0839', 'E0840', 'E0841', 'E0842', 'E0843', 'E0844', 'E0849', 'E0851', 'E0852', 'E0859', 'E08610', 'E08618', 'E08620', 'E08621', 'E08622', 'E08628', 'E08630', 'E08638', 'E08641', 'E08649', 'E0865', 'E0869', 'E088', 'E089', 'E0900', 'E0901', 'E0910', 'E0911', 'E0921', 'E0922', 'E0929', 'E09311', 'E09319', 'E09321', 'E09329', 'E09331', 'E09339', 'E09341', 'E09349', 'E09351', 'E09359', 'E0936', 'E0939', 'E0940', 'E0941', 'E0942', 'E0943', 'E0944', 'E0949', 'E0951', 'E0952', 'E0959', 'E09610', 'E09618', 'E09620', 'E09621', 'E09622', 'E09628', 'E09630', 'E09638', 'E09641', 'E09649', 'E0965', 'E0969', 'E098', 'E099', 'E1010', 'E1011', 'E1021', 'E1022', 'E1029', 'E10311', 'E10319', 'E10321', 'E10329', 'E10331', 'E10339', 'E10341', 'E10349', 'E10351', 'E10359', 'E1036', 'E1039', 'E1040', 'E1041', 'E1042', 'E1043', 'E1044', 'E1049', 'E1051', 'E1052', 'E1059', 'E10610', 'E10618', 'E10620', 'E10621', 'E10628', 'E10630', 'E10638', 'E10641', 'E10649', 'E1065', 'E1069', 'E108', 'E109', 'E1100', 'E1101', 'E1121', 'E1122', 'E1129', 'E11311', 'E11319', 'E11321', 'E11329', 'E11331', 'E11339', 'E11341', 'E11349', 'E11351', 'E11359', 'E1136', 'E1139', 'E1140', 'E1141', 'E1142', 'E1143', 'E1144', 'E1149', 'E1151', 'E1152', 'E1159', 'E11610', 'E11618', 'E11620', 'E11621', 'E11622', 'E11628', 'E11630', 'E11638', 'E11641', 'E11649', 'E1165', 'E1169', 'E118', 'E119', 'E1300', 'E1301', 'E1310', 'E1311', 'E1321', 'E1322', 'E1329', 'E13311', 'E13319', 'E13321', 'E13329', 'E13331', 'E13339', 'E13341', 'E13349', 'E13351', 'E13359', 'E1336', 'E1339', 'E1340', 'E1341', 'E1342', 'E1343', 'E1344', 'E1349', 'E1351', 'E1352', 'E1359', 'E13610', 'E13618', 'E13620', 'E13621', 'E13622', 'E13628', 'E13630', 'E13638', 'E13641', 'E13649', 'E1365', 'E1369', 'E138', 'E139') or 
       dx2 in: ('V8530', 'V8531', 'V8532', 'V8533', 'V8534', 'V8535', 'V8536', 'V8537', 'V8538', 'V8539', 'V8541', 'V8542', 'V8543', 'V8544', 'V8545', '27800', '27801', 'Z6830', 'Z6831', 'Z6832', 'Z6833', 'Z6834', 'Z6835', 'Z6836', 'Z6837', 'Z6838', 'Z6839', 'Z6841', 'Z6842', 'Z6843', 'Z6844', 'Z6845', 'E6601', 'E6609', 'E661', 'E668', 'E66', '4010', '4011', '4019', 'I10', '40200', '40201', '40210', '40211', '40290', '40291', 'I110', 'I119', '40300', '40301', '40310', '40311', '40390', '49391', 'I120', 'I129', '40400', '40401', '40402', '40403', '40410', '40411', '40412', '40413', '40490', '40491', '40492', '40493', 'I130', 'I1310', 'I1311', 'I132', '40501', '40509', '40511', '40519', '40591', '40599', 'I150', 'I151', 'I152', 'I158', 'I159', 'N262', '64201', '64203', '64204', '64211', '64213', '64214', '64221', '64223', '64224', '64230', '64231', '64233', '64234', '64291', '64293', '94294', 'O10011', 'O10012', 'O10013', 'O10019', 'O1002', 'O1003', 'O10111', 'O10112', 'O10113', 'O10119', 'O1012', 'O1013', 'O10211', 'O10212', 'O10213', 'O10219', 'O1022', 'O1023', 'O10311', 'O10312', 'O10313', 'O10319', 'O1032', 'O1033', 'O10411', 'O10412', 'O10413', 'O10419', 'O1042', 'O1043', 'O10911', 'O10912', 'O10913', 'O10919', 'O1092', 'O1093', 'O111', 'O112', 'O113', 'O119', 'O131', 'O132', 'O139', 'O161', 'O162', 'O163', 'O169', '24900', '24901', '24910', '24911', '24920', '24921', '24930', '24931', '24940', '24941', '24950', '24951', '24960', '24961', '24970', '24971', '24980', '24981', '24990', '24991', '25000', '25001', '25002', '25003', '25010', '25011', '25012', '25013', '25020', '25021', '25022', '25023', '25030', '25031', '25032', '25033', '25040', '25041', '25042', '25043', '25050', '25051', '25052', '25053', '25060', '25061', '25062', '25063', '25070', '25071', '25072', '25073', '25080', '25081', '25082', '25083', '25090', '25091', '25092', '25093', 'E0800', 'E0801', 'E0810', 'E0811', 'E0821', 'E0822', 'E0829', 'E08311', 'E08319', 'E08321', 'E08329', 'E08331', 'E08339', 'E08341', 'E08349', 'E08351', 'E08359', 'E0836', 'E0839', 'E0840', 'E0841', 'E0842', 'E0843', 'E0844', 'E0849', 'E0851', 'E0852', 'E0859', 'E08610', 'E08618', 'E08620', 'E08621', 'E08622', 'E08628', 'E08630', 'E08638', 'E08641', 'E08649', 'E0865', 'E0869', 'E088', 'E089', 'E0900', 'E0901', 'E0910', 'E0911', 'E0921', 'E0922', 'E0929', 'E09311', 'E09319', 'E09321', 'E09329', 'E09331', 'E09339', 'E09341', 'E09349', 'E09351', 'E09359', 'E0936', 'E0939', 'E0940', 'E0941', 'E0942', 'E0943', 'E0944', 'E0949', 'E0951', 'E0952', 'E0959', 'E09610', 'E09618', 'E09620', 'E09621', 'E09622', 'E09628', 'E09630', 'E09638', 'E09641', 'E09649', 'E0965', 'E0969', 'E098', 'E099', 'E1010', 'E1011', 'E1021', 'E1022', 'E1029', 'E10311', 'E10319', 'E10321', 'E10329', 'E10331', 'E10339', 'E10341', 'E10349', 'E10351', 'E10359', 'E1036', 'E1039', 'E1040', 'E1041', 'E1042', 'E1043', 'E1044', 'E1049', 'E1051', 'E1052', 'E1059', 'E10610', 'E10618', 'E10620', 'E10621', 'E10628', 'E10630', 'E10638', 'E10641', 'E10649', 'E1065', 'E1069', 'E108', 'E109', 'E1100', 'E1101', 'E1121', 'E1122', 'E1129', 'E11311', 'E11319', 'E11321', 'E11329', 'E11331', 'E11339', 'E11341', 'E11349', 'E11351', 'E11359', 'E1136', 'E1139', 'E1140', 'E1141', 'E1142', 'E1143', 'E1144', 'E1149', 'E1151', 'E1152', 'E1159', 'E11610', 'E11618', 'E11620', 'E11621', 'E11622', 'E11628', 'E11630', 'E11638', 'E11641', 'E11649', 'E1165', 'E1169', 'E118', 'E119', 'E1300', 'E1301', 'E1310', 'E1311', 'E1321', 'E1322', 'E1329', 'E13311', 'E13319', 'E13321', 'E13329', 'E13331', 'E13339', 'E13341', 'E13349', 'E13351', 'E13359', 'E1336', 'E1339', 'E1340', 'E1341', 'E1342', 'E1343', 'E1344', 'E1349', 'E1351', 'E1352', 'E1359', 'E13610', 'E13618', 'E13620', 'E13621', 'E13622', 'E13628', 'E13630', 'E13638', 'E13641', 'E13649', 'E1365', 'E1369', 'E138', 'E139') or 
       dx3 in: ('V8530', 'V8531', 'V8532', 'V8533', 'V8534', 'V8535', 'V8536', 'V8537', 'V8538', 'V8539', 'V8541', 'V8542', 'V8543', 'V8544', 'V8545', '27800', '27801', 'Z6830', 'Z6831', 'Z6832', 'Z6833', 'Z6834', 'Z6835', 'Z6836', 'Z6837', 'Z6838', 'Z6839', 'Z6841', 'Z6842', 'Z6843', 'Z6844', 'Z6845', 'E6601', 'E6609', 'E661', 'E668', 'E66', '4010', '4011', '4019', 'I10', '40200', '40201', '40210', '40211', '40290', '40291', 'I110', 'I119', '40300', '40301', '40310', '40311', '40390', '49391', 'I120', 'I129', '40400', '40401', '40402', '40403', '40410', '40411', '40412', '40413', '40490', '40491', '40492', '40493', 'I130', 'I1310', 'I1311', 'I132', '40501', '40509', '40511', '40519', '40591', '40599', 'I150', 'I151', 'I152', 'I158', 'I159', 'N262', '64201', '64203', '64204', '64211', '64213', '64214', '64221', '64223', '64224', '64230', '64231', '64233', '64234', '64291', '64293', '94294', 'O10011', 'O10012', 'O10013', 'O10019', 'O1002', 'O1003', 'O10111', 'O10112', 'O10113', 'O10119', 'O1012', 'O1013', 'O10211', 'O10212', 'O10213', 'O10219', 'O1022', 'O1023', 'O10311', 'O10312', 'O10313', 'O10319', 'O1032', 'O1033', 'O10411', 'O10412', 'O10413', 'O10419', 'O1042', 'O1043', 'O10911', 'O10912', 'O10913', 'O10919', 'O1092', 'O1093', 'O111', 'O112', 'O113', 'O119', 'O131', 'O132', 'O139', 'O161', 'O162', 'O163', 'O169', '24900', '24901', '24910', '24911', '24920', '24921', '24930', '24931', '24940', '24941', '24950', '24951', '24960', '24961', '24970', '24971', '24980', '24981', '24990', '24991', '25000', '25001', '25002', '25003', '25010', '25011', '25012', '25013', '25020', '25021', '25022', '25023', '25030', '25031', '25032', '25033', '25040', '25041', '25042', '25043', '25050', '25051', '25052', '25053', '25060', '25061', '25062', '25063', '25070', '25071', '25072', '25073', '25080', '25081', '25082', '25083', '25090', '25091', '25092', '25093', 'E0800', 'E0801', 'E0810', 'E0811', 'E0821', 'E0822', 'E0829', 'E08311', 'E08319', 'E08321', 'E08329', 'E08331', 'E08339', 'E08341', 'E08349', 'E08351', 'E08359', 'E0836', 'E0839', 'E0840', 'E0841', 'E0842', 'E0843', 'E0844', 'E0849', 'E0851', 'E0852', 'E0859', 'E08610', 'E08618', 'E08620', 'E08621', 'E08622', 'E08628', 'E08630', 'E08638', 'E08641', 'E08649', 'E0865', 'E0869', 'E088', 'E089', 'E0900', 'E0901', 'E0910', 'E0911', 'E0921', 'E0922', 'E0929', 'E09311', 'E09319', 'E09321', 'E09329', 'E09331', 'E09339', 'E09341', 'E09349', 'E09351', 'E09359', 'E0936', 'E0939', 'E0940', 'E0941', 'E0942', 'E0943', 'E0944', 'E0949', 'E0951', 'E0952', 'E0959', 'E09610', 'E09618', 'E09620', 'E09621', 'E09622', 'E09628', 'E09630', 'E09638', 'E09641', 'E09649', 'E0965', 'E0969', 'E098', 'E099', 'E1010', 'E1011', 'E1021', 'E1022', 'E1029', 'E10311', 'E10319', 'E10321', 'E10329', 'E10331', 'E10339', 'E10341', 'E10349', 'E10351', 'E10359', 'E1036', 'E1039', 'E1040', 'E1041', 'E1042', 'E1043', 'E1044', 'E1049', 'E1051', 'E1052', 'E1059', 'E10610', 'E10618', 'E10620', 'E10621', 'E10628', 'E10630', 'E10638', 'E10641', 'E10649', 'E1065', 'E1069', 'E108', 'E109', 'E1100', 'E1101', 'E1121', 'E1122', 'E1129', 'E11311', 'E11319', 'E11321', 'E11329', 'E11331', 'E11339', 'E11341', 'E11349', 'E11351', 'E11359', 'E1136', 'E1139', 'E1140', 'E1141', 'E1142', 'E1143', 'E1144', 'E1149', 'E1151', 'E1152', 'E1159', 'E11610', 'E11618', 'E11620', 'E11621', 'E11622', 'E11628', 'E11630', 'E11638', 'E11641', 'E11649', 'E1165', 'E1169', 'E118', 'E119', 'E1300', 'E1301', 'E1310', 'E1311', 'E1321', 'E1322', 'E1329', 'E13311', 'E13319', 'E13321', 'E13329', 'E13331', 'E13339', 'E13341', 'E13349', 'E13351', 'E13359', 'E1336', 'E1339', 'E1340', 'E1341', 'E1342', 'E1343', 'E1344', 'E1349', 'E1351', 'E1352', 'E1359', 'E13610', 'E13618', 'E13620', 'E13621', 'E13622', 'E13628', 'E13630', 'E13638', 'E13641', 'E13649', 'E1365', 'E1369', 'E138', 'E139') or 
       dx4 in: ('V8530', 'V8531', 'V8532', 'V8533', 'V8534', 'V8535', 'V8536', 'V8537', 'V8538', 'V8539', 'V8541', 'V8542', 'V8543', 'V8544', 'V8545', '27800', '27801', 'Z6830', 'Z6831', 'Z6832', 'Z6833', 'Z6834', 'Z6835', 'Z6836', 'Z6837', 'Z6838', 'Z6839', 'Z6841', 'Z6842', 'Z6843', 'Z6844', 'Z6845', 'E6601', 'E6609', 'E661', 'E668', 'E66', '4010', '4011', '4019', 'I10', '40200', '40201', '40210', '40211', '40290', '40291', 'I110', 'I119', '40300', '40301', '40310', '40311', '40390', '49391', 'I120', 'I129', '40400', '40401', '40402', '40403', '40410', '40411', '40412', '40413', '40490', '40491', '40492', '40493', 'I130', 'I1310', 'I1311', 'I132', '40501', '40509', '40511', '40519', '40591', '40599', 'I150', 'I151', 'I152', 'I158', 'I159', 'N262', '64201', '64203', '64204', '64211', '64213', '64214', '64221', '64223', '64224', '64230', '64231', '64233', '64234', '64291', '64293', '94294', 'O10011', 'O10012', 'O10013', 'O10019', 'O1002', 'O1003', 'O10111', 'O10112', 'O10113', 'O10119', 'O1012', 'O1013', 'O10211', 'O10212', 'O10213', 'O10219', 'O1022', 'O1023', 'O10311', 'O10312', 'O10313', 'O10319', 'O1032', 'O1033', 'O10411', 'O10412', 'O10413', 'O10419', 'O1042', 'O1043', 'O10911', 'O10912', 'O10913', 'O10919', 'O1092', 'O1093', 'O111', 'O112', 'O113', 'O119', 'O131', 'O132', 'O139', 'O161', 'O162', 'O163', 'O169', '24900', '24901', '24910', '24911', '24920', '24921', '24930', '24931', '24940', '24941', '24950', '24951', '24960', '24961', '24970', '24971', '24980', '24981', '24990', '24991', '25000', '25001', '25002', '25003', '25010', '25011', '25012', '25013', '25020', '25021', '25022', '25023', '25030', '25031', '25032', '25033', '25040', '25041', '25042', '25043', '25050', '25051', '25052', '25053', '25060', '25061', '25062', '25063', '25070', '25071', '25072', '25073', '25080', '25081', '25082', '25083', '25090', '25091', '25092', '25093', 'E0800', 'E0801', 'E0810', 'E0811', 'E0821', 'E0822', 'E0829', 'E08311', 'E08319', 'E08321', 'E08329', 'E08331', 'E08339', 'E08341', 'E08349', 'E08351', 'E08359', 'E0836', 'E0839', 'E0840', 'E0841', 'E0842', 'E0843', 'E0844', 'E0849', 'E0851', 'E0852', 'E0859', 'E08610', 'E08618', 'E08620', 'E08621', 'E08622', 'E08628', 'E08630', 'E08638', 'E08641', 'E08649', 'E0865', 'E0869', 'E088', 'E089', 'E0900', 'E0901', 'E0910', 'E0911', 'E0921', 'E0922', 'E0929', 'E09311', 'E09319', 'E09321', 'E09329', 'E09331', 'E09339', 'E09341', 'E09349', 'E09351', 'E09359', 'E0936', 'E0939', 'E0940', 'E0941', 'E0942', 'E0943', 'E0944', 'E0949', 'E0951', 'E0952', 'E0959', 'E09610', 'E09618', 'E09620', 'E09621', 'E09622', 'E09628', 'E09630', 'E09638', 'E09641', 'E09649', 'E0965', 'E0969', 'E098', 'E099', 'E1010', 'E1011', 'E1021', 'E1022', 'E1029', 'E10311', 'E10319', 'E10321', 'E10329', 'E10331', 'E10339', 'E10341', 'E10349', 'E10351', 'E10359', 'E1036', 'E1039', 'E1040', 'E1041', 'E1042', 'E1043', 'E1044', 'E1049', 'E1051', 'E1052', 'E1059', 'E10610', 'E10618', 'E10620', 'E10621', 'E10628', 'E10630', 'E10638', 'E10641', 'E10649', 'E1065', 'E1069', 'E108', 'E109', 'E1100', 'E1101', 'E1121', 'E1122', 'E1129', 'E11311', 'E11319', 'E11321', 'E11329', 'E11331', 'E11339', 'E11341', 'E11349', 'E11351', 'E11359', 'E1136', 'E1139', 'E1140', 'E1141', 'E1142', 'E1143', 'E1144', 'E1149', 'E1151', 'E1152', 'E1159', 'E11610', 'E11618', 'E11620', 'E11621', 'E11622', 'E11628', 'E11630', 'E11638', 'E11641', 'E11649', 'E1165', 'E1169', 'E118', 'E119', 'E1300', 'E1301', 'E1310', 'E1311', 'E1321', 'E1322', 'E1329', 'E13311', 'E13319', 'E13321', 'E13329', 'E13331', 'E13339', 'E13341', 'E13349', 'E13351', 'E13359', 'E1336', 'E1339', 'E1340', 'E1341', 'E1342', 'E1343', 'E1344', 'E1349', 'E1351', 'E1352', 'E1359', 'E13610', 'E13618', 'E13620', 'E13621', 'E13622', 'E13628', 'E13630', 'E13638', 'E13641', 'E13649', 'E1365', 'E1369', 'E138', 'E139')) and 
       proc1 in: ('97802', '97803', '97804', '99401', '99402', '99403', '99404', 'G0446', 'G0447', '99411', '99412', 'G0270', 'G0271', 'G0449', 'S9470')) then svc_obesity = 1;
   else svc_obesity = 0; 

   /*Wellness Visits */;
   if ((dx1 in: ('V030', 'V031', 'V032', 'V033', 'V034', 'V035', 'V036', 'V037', 'V038', 'V0381', 'V0382', 'V0389', 'V039', 'V040', 'V041', 'V042', 'V043', 'V044', 'V045', 'V046', 'V047', 'V048', 'V0481', 'V0482', 'V0489', 'V049', 'V050', 'V051', 'V052', 'V053', 'V054', 'V058', 'V059', 'V060', 'V061', 'V062', 'V063', 'V064', 'V065', 'V066', 'V068', 'V069', 'V200', 'V201', 'V202', 'V203', 'V2031', 'V2032', 'V700', 'V242', 'V723', 'V7231', 'V762', 'V7646', 'V7647', 'V8402', 'V8404', 'Z761', 'Z762', 'Z00121', 'Z00129', 'Z00110', 'Z00111', 'Z7681', 'Z0000', 'Z0001', 'Z008', 'Z01411', 'Z01419', 'Z134', 'Z136', 'Z0130', 'Z0133', 'Z003', 'V653', 'V6542', 'V6544', 'V6545', 'Z713', 'Z717', 'Z7141', 'Z713', 'Z7141', 'Z1389', 'Z1331', 'Z1332', 'Z23', 'Z392', 'Z124', 'Z1273', 'Z1272', 'Z1502', 'Z1504') or 
       dx2 in: ('V030', 'V031', 'V032', 'V033', 'V034', 'V035', 'V036', 'V037', 'V038', 'V0381', 'V0382', 'V0389', 'V039', 'V040', 'V041', 'V042', 'V043', 'V044', 'V045', 'V046', 'V047', 'V048', 'V0481', 'V0482', 'V0489', 'V049', 'V050', 'V051', 'V052', 'V053', 'V054', 'V058', 'V059', 'V060', 'V061', 'V062', 'V063', 'V064', 'V065', 'V066', 'V068', 'V069', 'V200', 'V201', 'V202', 'V203', 'V2031', 'V2032', 'V700', 'V242', 'V723', 'V7231', 'V762', 'V7646', 'V7647', 'V8402', 'V8404', 'Z761', 'Z762', 'Z00121', 'Z00129', 'Z00110', 'Z00111', 'Z7681', 'Z0000', 'Z0001', 'Z008', 'Z01411', 'Z01419', 'Z134', 'Z136', 'Z0130', 'Z0133', 'Z003', 'V653', 'V6542', 'V6544', 'V6545', 'Z713', 'Z717', 'Z7141', 'Z713', 'Z7141', 'Z1389', 'Z1331', 'Z1332', 'Z23', 'Z392', 'Z124', 'Z1273', 'Z1272', 'Z1502', 'Z1504') or 
       dx3 in: ('V030', 'V031', 'V032', 'V033', 'V034', 'V035', 'V036', 'V037', 'V038', 'V0381', 'V0382', 'V0389', 'V039', 'V040', 'V041', 'V042', 'V043', 'V044', 'V045', 'V046', 'V047', 'V048', 'V0481', 'V0482', 'V0489', 'V049', 'V050', 'V051', 'V052', 'V053', 'V054', 'V058', 'V059', 'V060', 'V061', 'V062', 'V063', 'V064', 'V065', 'V066', 'V068', 'V069', 'V200', 'V201', 'V202', 'V203', 'V2031', 'V2032', 'V700', 'V242', 'V723', 'V7231', 'V762', 'V7646', 'V7647', 'V8402', 'V8404', 'Z761', 'Z762', 'Z00121', 'Z00129', 'Z00110', 'Z00111', 'Z7681', 'Z0000', 'Z0001', 'Z008', 'Z01411', 'Z01419', 'Z134', 'Z136', 'Z0130', 'Z0133', 'Z003', 'V653', 'V6542', 'V6544', 'V6545', 'Z713', 'Z717', 'Z7141', 'Z713', 'Z7141', 'Z1389', 'Z1331', 'Z1332', 'Z23', 'Z392', 'Z124', 'Z1273', 'Z1272', 'Z1502', 'Z1504') or 
       dx4 in: ('V030', 'V031', 'V032', 'V033', 'V034', 'V035', 'V036', 'V037', 'V038', 'V0381', 'V0382', 'V0389', 'V039', 'V040', 'V041', 'V042', 'V043', 'V044', 'V045', 'V046', 'V047', 'V048', 'V0481', 'V0482', 'V0489', 'V049', 'V050', 'V051', 'V052', 'V053', 'V054', 'V058', 'V059', 'V060', 'V061', 'V062', 'V063', 'V064', 'V065', 'V066', 'V068', 'V069', 'V200', 'V201', 'V202', 'V203', 'V2031', 'V2032', 'V700', 'V242', 'V723', 'V7231', 'V762', 'V7646', 'V7647', 'V8402', 'V8404', 'Z761', 'Z762', 'Z00121', 'Z00129', 'Z00110', 'Z00111', 'Z7681', 'Z0000', 'Z0001', 'Z008', 'Z01411', 'Z01419', 'Z134', 'Z136', 'Z0130', 'Z0133', 'Z003', 'V653', 'V6542', 'V6544', 'V6545', 'Z713', 'Z717', 'Z7141', 'Z713', 'Z7141', 'Z1389', 'Z1331', 'Z1332', 'Z23', 'Z392', 'Z124', 'Z1273', 'Z1272', 'Z1502', 'Z1504')) and 
       proc1 in: ('99201', '99202', '99203', '99204', '99205', '99211', '99212', '99213', '99214', '99215', '99385', '99386', '99387', ' 99395', '99396', '99397', '99401', '99402', '99403', '99404', '99411', '99412', 'G0101', 'G0344', 'G0402', 'G0438', 'G0439', 'G0445', 'S0610', 'S0612', 'S0613')) then svc_wellness = 1;
   else svc_wellness = 0;

   /*Dyslipidemia Screening */;
   if ((dx1 in: ('V202', 'V7791', 'Z00129', 'Z13220') or 
       dx2 in: ('V202', 'V7791', 'Z00129', 'Z13220') or 
       dx3 in: ('V202', 'V7791', 'Z00129', 'Z13220') or 
       dx4 in: ('V202', 'V7791', 'Z00129', 'Z13220')) and 
       proc1 in: ('36415', '36416', '80061', '82465', '83718', '83719', '83721', '84478')) then svc_dyslipidemia = 1;
   else svc_dyslipidemia = 0; 

        if svc_contraceptive = 1 or svc_subab = 1 or svc_cancerscreen = 1 or svc_cholesterol = 1 or svc_depression = 1 or svc_diabetes = 1 or 
	   svc_immunization = 1 or svc_obesity = 1 or svc_wellness = 1 or svc_dyslipidemia = 1; 
run;

*Export claims; 
proc export data=out.outpatient2009
    outfile = "/project/caretaking/AllFamilies_Prevention_2009.dta"
    dbms=stata
    replace;
run; 

/*-----------------*
* Delete SAS data *
*------------------*/; 

proc delete data=out.outpatient2009;
run; 

